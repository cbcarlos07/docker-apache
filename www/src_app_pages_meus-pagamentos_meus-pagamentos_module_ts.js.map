{"version":3,"mappings":"8VAYEA,sCACEA,qDAKEA,uHAAoBC,sBACrBD,2BACHA,uEANIA,yEAAuB,oBAAvBA,CAAuB,kCAAvBA,CAAuB,oCCT7B,MAAME,EAAiB,CACrB,CACEC,KAAM,GACNC,UCcJ,MAAM,QASJC,YACUC,EACAC,EACAC,GAFAC,cACAA,gBACAA,YATHA,eAAY,IAAIC,MAEhBD,oBAAyB,EAEzBA,gBAAqB,EASrBA,WAAuB,CAC5B,CACEE,GAAI,IACJC,MAAO,OACPC,KAAM,KAER,CACEF,GAAI,IACJC,MAAO,aACPC,KAAM,WAER,CACEF,GAAI,IACJC,MAAO,oBAIJH,oBAAiB,qCAExBK,kBACEL,KAAKM,gBAGCA,gBAENN,KAAKH,OAAOU,iBAAgB,GAE5BP,KAAKD,KAAKS,IAAS,GAAGC,iBAAsBC,UAAUC,IAEpD,IAAKA,IAAaA,EAASC,QAAS,OAEpCZ,KAAKa,QAAUF,EAASE,QAExB,MAAMC,EAAab,MAAMc,QAAQJ,EAASK,MAA0BL,EAASK,KAA3B,CAACL,EAASK,MAC5DhB,KAAKc,UAAYA,EACjBd,KAAKH,OAAOU,iBAAgB,GAC5BP,KAAKiB,WAAY,EAEbjB,KAAKc,UAAUI,OAAS,IAG1BlB,KAAKmB,iBAEDC,KADuBN,UAAU,GACnBO,UAChBrB,KAAKsB,8BAMLA,2BACNtB,KAAKuB,eAAiB,EACtBvB,KAAKc,UAAU,GAAGU,aAAaC,QAAQC,IACX,YAAtBA,EAAYC,QACd3B,KAAKuB,mBAITvB,KAAKF,SAAS8B,WAAW,CACvBC,KAAM,gBACNC,KAAM,UACNC,OAAQ,sBACRC,SALU,qKAMT,WAAW,GAGRb,iBACNc,QAAQC,IAAI,kBACZlC,KAAKc,UAAU,GAAGU,aAAaC,QAAQC,IACrCA,EAAYS,MAAO,EACO,QAAtBT,EAAYC,SACdD,EAAYS,KAAOnC,KAAKoC,mBAAmBV,EAAYW,iBAOrDD,mBAAoBE,GAC1B,MAAMC,EAAQC,IACRC,EAAeD,EAAOF,EAAe,cAI3C,QAFaC,EAAMG,KAAKD,EAAc,OAChB,IAIjBE,iBAAiBC,GACtB5C,KAAKuB,eAAiB,EAClBqB,EAAGC,QAAUD,EAAGC,OAAOC,WACrBF,EAAGC,OAAOC,SAASzB,UACrBrB,KAAKsB,2BAGPtB,KAAKmB,gEA9GE4B,GAAuBxD,4JAAvBwD,EAAuBC,sVFtBpCzD,sCACEA,4CACFA,2BACAA,sCACEA,sCACEA,oCAAiBA,wCAAeA,2BAClCA,2BAEAA,sCACEA,iCACFA,2BAEAA,wCASFA,kCApBkBA,iEAWQA,+oHEUbwD,GAAb,KDNO,IAAME,EAAb,MAAM,sDAAOA,0GAHF,CAACC,cAAsBzD,IACtByD,QAECD,GAAb,iBEMO,IAAME,EAAb,MAAM,sDAAOA,0GAZF,CACPC,KACAC,IACAJ,MASSE,GAAb","names":["i0","ctx_r1","routes","path","component","constructor","shared","alertMsg","http","this","Array","id","label","link","ngAfterViewInit","loadContracts","setLoadingAtivo","get","API_BE_V3","subscribe","response","success","message","contracts","isArray","data","isLoading","length","verifyShowFlag","firstContract","Pendente","showOverdueMonthlyFeeMsg","countPendentes","Mensalidades","forEach","mensalidade","Status","openDialog","icon","tipo","titulo","mensagem","console","log","Show","verifyDataCobranca","DataCobranca","data_cobranca","today","moment","dataCobranca","diff","onSwitchContract","ev","detail","contract","MeusPagamentosComponent","selectors","MeusPagamentosRoutingModule","RouterModule","MeusPagamentosModule","CommonModule","SharedModule"],"sources":["./src/app/pages/meus-pagamentos/meus-pagamentos.component.html","./src/app/pages/meus-pagamentos/meus-pagamentos-routing.module.ts","./src/app/pages/meus-pagamentos/meus-pagamentos.component.ts","./src/app/pages/meus-pagamentos/meus-pagamentos.module.ts"],"sourcesContent":["<div class=\"container\">\n  <app-breadcrumb [steps]=\"steps\" class=\"steps-header\"></app-breadcrumb>\n</div>\n<div class=\"payments-header\">\n  <div class=\"container\">\n    <p class=\"title\">Meus pagamentos</p>\n  </div>\n\n  <div class=\"container\">\n    <div class=\"single-line\"> </div>\n  </div>\n\n  <div class=\"container\" *ngIf=\"!isLoading\">\n    <movida-my-payments\n      [contracts]=\"contracts\"\n      [message]=\"message\"\n      [regularizeLink]=\"regularizeLink\"\n      [countPendentes]=\"countPendentes\"\n      (switched-contract)=onSwitchContract($event)\n    ></movida-my-payments>\n  </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MeusPagamentosComponent } from './meus-pagamentos.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MeusPagamentosComponent\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class MeusPagamentosRoutingModule { }","/**\n * @author\n * Movida S.A\n * @link\n * https://www.movida.com.br/\n * @license\n * Copyright Movida S.A All Rights Reserved.\n */\n//import { DOCUMENT } from '@angular/common';\nimport { HttpClient } from '@angular/common/http';\nimport { AfterViewInit, Component, Input } from '@angular/core';\nimport { API_BE_V3 } from 'src/app/core/api/app.api';\nimport { AlertMessageComponent } from 'src/app/shared/alert-message/alert-message.component';\nimport { IBreadcrumb } from 'src/app/shared/breadcrumb/breadcrumb.component';\nimport { MainSharedService } from 'src/app/util/shared.service';\nimport * as moment from 'moment';\n\n@Component({\n  selector: 'app-meus-pagamentos',\n  templateUrl: './meus-pagamentos.component.html',\n  styleUrls: ['./meus-pagamentos.component.scss']\n})\nexport class MeusPagamentosComponent implements AfterViewInit {\n\n  @Input() finishedRegister: true;\n  public contracts = new Array<any>();\n  public message: string;\n  public countPendentes: number = 0;\n\n  public isLoading: boolean = true;\n\n  constructor(\n    private shared: MainSharedService,\n    private alertMsg: AlertMessageComponent,\n    private http: HttpClient,\n   // @Inject(DOCUMENT) private document\n  ) { }\n\n  public steps: IBreadcrumb[] = [\n    {\n      id: '0',\n      label: 'Home',\n      link: '/'\n    },\n    {\n      id: '1',\n      label: 'Meu portal',\n      link: '/portal'\n    },\n    {\n      id: '2',\n      label: 'Meus pagamentos'\n    }\n  ];\n\n  public regularizeLink = 'portal/meus-pagamentos/regularize/';\n\n  ngAfterViewInit() {\n    this.loadContracts();\n  }\n\n  private loadContracts(): void {\n\n    this.shared.setLoadingAtivo(true);\n\n    this.http.get<any>(`${API_BE_V3}/payments`).subscribe(response => {\n\n      if (!response || !response.success) return;\n\n      this.message = response.message;\n\n      const contracts = !Array.isArray(response.data) ? [response.data] : response.data;\n      this.contracts = contracts;\n      this.shared.setLoadingAtivo(false);\n      this.isLoading = false;\n\n      if (this.contracts.length > 0) {\n\n        // this.contracts[0].Mensalidades[0].DataCobranca = \"25/06/2021\"\n        this.verifyShowFlag();\n        const firstContract = this.contracts[0];\n        if (firstContract.Pendente) {\n          this.showOverdueMonthlyFeeMsg();\n        }\n      }\n    });\n  }\n\n  private showOverdueMonthlyFeeMsg(): void {\n    this.countPendentes = 0;\n    this.contracts[0].Mensalidades.forEach(mensalidade => {\n      if (mensalidade.Status == \"Pendente\") {\n        this.countPendentes ++;\n      }\n    });\n    const msg = 'Regularize o pagamento e evite a interrupção do serviço. Em caso de dúvida entre em contato com a nossa central através do telefone 0800 771 8400.';\n    this.alertMsg.openDialog({\n      icon: 'attention.svg',\n      tipo: 'warning',\n      titulo: 'Pagamento pendente!',\n      mensagem: msg\n    }, 'message', true);\n  }\n\n  private verifyShowFlag() {\n    console.log(\"verifyShowFlag\");\n    this.contracts[0].Mensalidades.forEach(mensalidade => {\n      mensalidade.Show = true;\n      if (mensalidade.Status == \"Pago\") {\n        mensalidade.Show = this.verifyDataCobranca(mensalidade.DataCobranca);\n      }\n    });\n\n    // console.log(\"this.contracts\", this.contracts);\n  }\n\n  private verifyDataCobranca (data_cobranca) {\n    const today = moment();\n    const dataCobranca = moment(data_cobranca, \"DD/MM/YYYY\");\n\n    const diff = today.diff(dataCobranca, 'day');\n    const result = diff > 30 ? false : true;\n    return result;\n  }\n\n  public onSwitchContract(ev) {\n    this.countPendentes = 0;\n    if (ev.detail && ev.detail.contract) {\n      if (ev.detail.contract.Pendente) {\n        this.showOverdueMonthlyFeeMsg();\n      }\n\n      this.verifyShowFlag();\n    }\n  }\n}\n","//modules\nimport { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MeusPagamentosRoutingModule } from './meus-pagamentos-routing.module';\nimport { SharedModule } from 'src/app/shared/shared.module';\n\n//components\nimport { MeusPagamentosComponent } from './meus-pagamentos.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    SharedModule,\n    MeusPagamentosRoutingModule\n  ],\n  declarations: [\n    MeusPagamentosComponent,\n  ],\n  schemas: [\n    CUSTOM_ELEMENTS_SCHEMA\n  ],\n})\nexport class MeusPagamentosModule { }\n"],"sourceRoot":"webpack:///","file":"src_app_pages_meus-pagamentos_meus-pagamentos_module_ts.js"}